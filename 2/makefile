LED1_PORT = B
LED1_PIN = 2
LED2_PORT = B
LED2_PIN = 4
LEDOUT_PORT = B
LEDOUT_PIN = 1
B1_PORT = B
B1_PIN = 3
B2_PORT = B
B2_PIN = 5
SWITCH_PORT = B
SWITCH_PIN = 0

MCU=attiny13
F_CPU=1200000
CC=avr-gcc
OBJCOPY=avr-objcopy
CFLAGS=-std=c99 -Wall -g -Os -mmcu=${MCU} -DF_CPU=${F_CPU} -I.
TARGET=main
SRCS=main.c

ifeq ($(LED1_PORT), B)
	DDR_L1 = DDRB
	PORT_L1 = PORTB
	PIN_L1 =PINB
else
	DDR_L1 =DDRA
	PORT_L1 =PORTA
	PIN_L1 =PINA
endif

ifeq ($(LED2_PORT), B)
	DDR_L2 = DDRB
	PORT_L2 =PORTB
	PIN_L2 =PINB
else
	DDR_L2 =DDRA
	PORT_L2 =PORTA
	PIN_L2 =PINA
endif

ifeq ($(B1_PORT), B)
	DDR_B1 = DDRB
	PORT_B1 =PORTB
	PIN_B1 =PINB
else
	DDR_B1 =DDRA
	PORT_B1 =PORTA
	PIN_B1 =PINA
endif

ifeq ($(B2_PORT), B)
	DDR_B2 = DDRB
	PORT_B2 =PORTB
	PIN_B2 =PINB
else
	DDR_B2 =DDRA
	PORT_B2 =PORTA
	PIN_B2 =PINA
endif

ifeq ($(LEDOUT_PORT), B)
	DDR_LEDOUT = DDRB
	PORT_LEDOUT =PORTB
	PIN_LEDOUT =PINB
else
	DDR_LEDOUT =DDRA
	PORT_LEDOUT =PORTA
	PIN_LEDOUT =PINA
endif

ifeq ($(SWITCH_PORT), B)
	DDR_SWITCH = DDRB
	PORT_SWITCH =PORTB
	PIN_SWITCH =PINB
else
	DDR_SWITCH =DDRA
	PORT_SWITCH =PORTA
	PIN_SWITCH =PINA
endif

all:
	${CC} ${CFLAGS} -DMCU=${MCU} \
	-DLED1_PORT=${LED1_PORT} -DLED1_PIN=${LED1_PIN} \
	-DLED2_PORT=${LED2_PORT} -DLED2_PIN=${LED2_PIN} \
	-DLEDOUT_PORT=${LEDOUT_PORT} -DLEDOUT_PIN=${LEDOUT_PIN} \
	-DB1_PORT=${B1_PORT} -DB1_PIN=${B1_PIN} \
	-DB2_PORT=${B2_PORT} -DB2_PIN=${B2_PIN} \
	-DSWITCH_PORT=${SWITCH_PORT} -DSWITCH_PIN=${SWITCH_PIN} \
	-DDDR_L1=${DDR_L1} -DPORT_L1=${PORT_L1} -DPIN_L1=${PIN_L1} \
	-DDDR_L2=${DDR_L2} -DPORT_L2=${PORT_L2} -DPIN_L2=${PIN_L2} \
	-DDDR_LEDOUT=${DDR_LEDOUT} -DPORT_LEDOUT=${PORT_LEDOUT} -DPIN_LEDOUT=${PIN_LEDOUT} \
	-DDDR_B1=${DDR_B1} -DPORT_B1=${PORT_B1} -DPIN_B1=${PIN_B1} \
	-DDDR_B2=${DDR_B2} -DPORT_B2=${PORT_B2} -DPIN_B2=${PIN_B2} \
	-DDDR_SWITCH=${DDR_SWITCH} -DPORT_SWITCH=${PORT_SWITCH} -DPIN_SWITCH=${PIN_SWITCH} \
	-o ${TARGET}.bin ${SRCS}
	${OBJCOPY} -j .text -j .data -O ihex ${TARGET}.bin ${TARGET}.hex

